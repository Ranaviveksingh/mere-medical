version: '3.9'

services:
  web:
    image: registry.mari.casa/mari-medical-web:latest
    ports:
      - '4200:80'
    environment:
      - ONPATIENT_REDIRECT_URI=${ONPATIENT_REDIRECT_URI}
      - ONPATIENT_CLIENT_ID=${ONPATIENT_CLIENT_ID}
      - DATABASE_NAME=${DATABASE_NAME}
      - PUBLIC_URL=${PUBLIC_URL}
  api:
    image: registry.mari.casa/mari-medical-api:latest
    ports:
      - '4201:4201'
    environment:
      - NX_ONPATIENT_CLIENT_SECRET=${ONPATIENT_CLIENT_SECRET}
      - NX_ONPATIENT_CLIENT_ID=${ONPATIENT_CLIENT_ID}
      - NX_ONPATIENT_REDIRECT=${ONPATIENT_REDIRECT}
      - NX_FRONTEND_APP_REDIRECT=${FRONTEND_APP_REDIRECT}
  # couchserver:
  #   image: couchdb
  #   restart: always
  #   ports:
  #     - '5984:5984'
  #   environment:
  #     - COUCHDB_USER=admin
  #     - COUCHDB_PASSWORD=YOURPASSWORD
  #   volumes:
  #     - /mnt/data/mari-medical/cdb:/opt/couchdb/data
